{
	"version": 0.1,
	"checks": {
		"employee.daily-whrs-capacity.exceed": {
			"type": "limit.exceed",
			"violation": {
				"severity": "warning",
				"message": "employee max capality ({} whrs per day) exceed"
			},
			"input": {
				"extract": {
					"extract.field": "whrs",
					"match": ["employee", "date", "key", "group"],
					"collection": "sprint.assignments"
				}			
			},
			"dependent": {
				"calculate": {
					"calc.func": "sum",
					"agg.field": "whrs",
					"agg.collection": "sprint.assignments",
					"agg.group": ["employee", "date"]
				}				
			},
			"constraint": {
				"constant": {
					"value": 6
				}
			}
		},
		"task.originalestimate.exceed": {
			"type": "limit.exceed",
			"violation": {
				"severity": "warning",
				"message": "Task original estimate ({} hrs) exceed"
			},
			"input": {
				"extract": {
					"extract.field": "whrs",
					"match": ["employee", "date", "key", "group"],
					"collection": "sprint.assignments"
				}			
			},
			"dependent": {
				"calculate": {
					"calc.func": "sum",
					"agg.field": "whrs",
					"agg.collection": "sprint.assignments",
					"agg.group": ["employee", "date"]
				}				
			},
			"constraint": {
				"extract": {
					"extract.field": "estimate",
					"match": ["key"],
					"collection": "sprint.backlog",
					"default": 9999
				}			
			}
		},
		"task.duedate.overdue": {
			"type": "date.overdue",
			"violation": {
				"severity": "warning",
				"message": "task's due date {} is passed"
			},
			"input": {
				"extract": {
					"extract.field": "date",
					"match": ["employee", "date", "key", "group"],
					"collection": "sprint.assignments"
				}
			},
			"constraint": {
				"extract": {
					"extract.field": "duedate",
					"match": ["key"],
					"collection": "sprint.backlog",
					"default": "9999-12-31"
				}
			}		
		},
		"assignment.expertise.conflict": {
			"type": "sets.intersection",
			"violation": {
				"severity": "warning",
				"message": "Task requires {} component(s) expertise"
			},
			"input": {
				"extract": {
					"extract.field": "key",
					"match": ["employee", "date", "key", "group"],
					"collection": "sprint.assignments"
				}
			},
			"dependent": {
				"extract": {
					"extract.field": "components",
					"match": ["key"],
					"collection": "sprint.backlog"
				}
			},			
			"constraint": {
				"extract": {
					"extract.field": "components",
					"match": ["group"],
					"collection": "project.team"
				}
			}			
		},
		"assignment.blocked.conflict": {
			"type": "schedule.integrity",
			"violation": {
				"severity": "warning",
				"message": "Conflict with blocked {} assignment {}"
			},
			"input": {
				"extract": {
					"extract.field": "date",
					"match": ["employee", "date", "key", "group"],
					"collection": "sprint.assignments"
				}
			},
			"dependent": {
				"extract": {
					"extract.field": "blocks",
					"match": ["key"],
					"collection": "sprint.backlog"
				}
			},			
			"constraint": {
				"calculate": {
					"calc.func": "min",
					"agg.field": "date",
					"agg.collection": "sprint.assignments",
					"agg.group": ["key"],
					"default": "9999-12-31"
				}	
			}		
		}		
	}
}