{
	"version": 0.1,
	"checks": {
		"employee.daily-whrs-capacity.exceed": {
			"type": "limit.exceed",
			"violation": {
				"severity": "warning",
				"message": "employee max capality ({:g} whrs per day) exceed"
			},
			"input": {
				"object": {
					"extract.field": "whrs"
				}
			},
			"target": {
				"extract": {
					"extract.field": "whrs",
					"field.type": "float",
					"match": ["employee", "date", "key", "group"],
					"collection": "sprint.assignments",
					"default": 0
				}			
			},					
			"dependent": {
				"calculate": {
					"calc.func": "sum",
					"agg.field": "whrs",
					"field.type": "float",					
					"agg.collection": "sprint.assignments",
					"agg.group": ["employee", "date"],
					"default": 0
				}				
			},
			"constraint": {
				"constant": {
					"value": 6
				}
			}
		},
		"group.sprint-whrs-capacity.exceed": {
			"type": "limit.exceed",
			"violation": {
				"severity": "warning",
				"message": "Group max capality ({:g} whrs per sprint) exceed"
			},
			"input": {
				"object": {
					"extract.field": "whrs"
				}
			},
			"target": {
				"extract": {
					"extract.field": "whrs",
					"field.type": "float",
					"match": ["employee", "date", "key", "group"],
					"collection": "sprint.assignments",
					"default": 0
				}			
			},					
			"dependent": {
				"calculate": {
					"calc.func": "sum",
					"agg.field": "whrs",
					"field.type": "float",					
					"agg.collection": "sprint.assignments",
					"agg.group": ["group"],
					"default": 0
				}				
			},
			"constraint": {
				"extract": {
					"extract.field": "capacity",
					"field.type": "float",
					"match": ["group"],
					"collection": "project.team",
					"default": 9999
				}
			}
		},		
		"task.originalestimate.exceed": {
			"type": "limit.exceed",
			"violation": {
				"severity": "warning",
				"message": "Task original estimate ({:g} hrs) exceed"
			},
			"input": {
				"object": {
					"extract.field": "whrs"
				}
			},
			"target": {
				"extract": {
					"extract.field": "whrs",
					"field.type": "float",
					"match": ["employee", "date", "key", "group"],
					"collection": "sprint.assignments",
					"default": 0
				}			
			},
			"dependent": {
				"calculate": {
					"calc.func": "sum",
					"agg.field": "whrs",
					"field.type": "float",					
					"agg.collection": "sprint.assignments",
					"agg.group": ["employee", "date"],
					"default": 0
				}				
			},
			"constraint": {
				"extract": {
					"extract.field": "estimate",
					"field.type": "float",
					"match": ["key"],
					"collection": "sprint.backlog",
					"default": 9999
				}			
			}
		},
		"task.duedate.overdue": {
			"type": "date.overdue",
			"violation": {
				"severity": "warning",
				"message": "task's due date {:%Y-%m-%d} is passed"
			},
			"input": {
				"object": {
					"extract.field": "date",
					"field.type": "date"
				}
			},
			"constraint": {
				"extract": {
					"extract.field": "duedate",
					"field.type": "date",
					"match": ["key"],
					"collection": "sprint.backlog",
					"default": "9999-12-31"
				}
			}		
		},
		"assignment.expertise.conflict": {
			"type": "sets.intersection",
			"violation": {
				"severity": "warning",
				"message": "Task requires {} component(s) expertise"
			},
			"dependent": {
				"extract": {
					"extract.field": "components",
					"match": ["key"],
					"collection": "sprint.backlog"
				}
			},			
			"constraint": {
				"extract": {
					"extract.field": "components",
					"match": ["group"],
					"collection": "project.team"
				}
			}			
		},
		"assignment.blocked.conflict": {
			"type": "schedule.integrity",
			"violation": {
				"severity": "warning",
				"message": "Conflict with blocked {} assignment {:%Y-%m-%d}"
			},
			"input": {
				"object": {
					"extract.field": "date",
					"field.type": "date"
				}
			},
			"dependent": {
				"extract": {
					"extract.field": "blocks",
					"match": ["key"],
					"collection": "sprint.backlog"
				}
			},			
			"constraint": {
				"calculate": {
					"calc.func": "min",
					"agg.field": "date",
					"field.type": "date",					
					"agg.collection": "sprint.assignments",
					"agg.group": ["key"],
					"default": "9999-12-31"
				}	
			}		
		}		
	}
}